<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Lambda OS: kernel/src/mm/paging.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Lambda OS
   </div>
   <div id="projectbrief">HobbyoperatingsystemcreatedinC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('paging_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">paging.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="types_8h_source.html">types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="print_8h_source.html">dev/vga/print.h</a>&gt;</code><br/>
</div>
<p><a href="paging_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6ce6be4831ec09237b26ea3a826c6ebc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a6ce6be4831ec09237b26ea3a826c6ebc">set_frame</a> (<a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> frame, <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> val)</td></tr>
<tr class="memdesc:a6ce6be4831ec09237b26ea3a826c6ebc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes the frame unavailable or available. Sets the current frame to be used or unused, depending on <code>val</code>.  <a href="#a6ce6be4831ec09237b26ea3a826c6ebc">More...</a><br/></td></tr>
<tr class="separator:a6ce6be4831ec09237b26ea3a826c6ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec230565edc62c3911800334ba8357bb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#aec230565edc62c3911800334ba8357bb">test_frame</a> (<a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> frame)</td></tr>
<tr class="memdesc:aec230565edc62c3911800334ba8357bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the frame is available Checks if the frame is not being used.  <a href="#aec230565edc62c3911800334ba8357bb">More...</a><br/></td></tr>
<tr class="separator:aec230565edc62c3911800334ba8357bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8b2a17d9a96f0148b6a3b249669c2c"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a4e8b2a17d9a96f0148b6a3b249669c2c">get_free_frame</a> ()</td></tr>
<tr class="memdesc:a4e8b2a17d9a96f0148b6a3b249669c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the first free frame. Look through ass the pages, and see if any are available.  <a href="#a4e8b2a17d9a96f0148b6a3b249669c2c">More...</a><br/></td></tr>
<tr class="separator:a4e8b2a17d9a96f0148b6a3b249669c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0692bf8dce3ee5883abdba6625491437"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a0692bf8dce3ee5883abdba6625491437">alloc_frame</a> ()</td></tr>
<tr class="memdesc:a0692bf8dce3ee5883abdba6625491437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a frame. Allocates a page frame then returns its address.  <a href="#a0692bf8dce3ee5883abdba6625491437">More...</a><br/></td></tr>
<tr class="separator:a0692bf8dce3ee5883abdba6625491437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f2e5bf7896e25c26ba9e0ea4a70715"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a84f2e5bf7896e25c26ba9e0ea4a70715">free_frame</a> (void *frame)</td></tr>
<tr class="memdesc:a84f2e5bf7896e25c26ba9e0ea4a70715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free an allocated frame. Free an allocated page frame, allowing it to be allocated again.  <a href="#a84f2e5bf7896e25c26ba9e0ea4a70715">More...</a><br/></td></tr>
<tr class="separator:a84f2e5bf7896e25c26ba9e0ea4a70715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dec1d6d8c55ad0fafff3656c7cee62e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a0dec1d6d8c55ad0fafff3656c7cee62e">clear_pagedir</a> (<a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *dir)</td></tr>
<tr class="memdesc:a0dec1d6d8c55ad0fafff3656c7cee62e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear a page directory to it's default values. Clear the page directory marking every page table as non-existant.  <a href="#a0dec1d6d8c55ad0fafff3656c7cee62e">More...</a><br/></td></tr>
<tr class="separator:a0dec1d6d8c55ad0fafff3656c7cee62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7992cc47468ac72eeb8f08f94f210d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#ac7992cc47468ac72eeb8f08f94f210d2">fill_pagetable</a> (<a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *table, <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> addr)</td></tr>
<tr class="memdesc:ac7992cc47468ac72eeb8f08f94f210d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a page table with pages. Fill a pagetable with pages starting from <code>addr</code> and ending up at <code>addr + 0x400000</code>  <a href="#ac7992cc47468ac72eeb8f08f94f210d2">More...</a><br/></td></tr>
<tr class="separator:ac7992cc47468ac72eeb8f08f94f210d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44844a86a2d9dfe3c92936bbe16d2d0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a44844a86a2d9dfe3c92936bbe16d2d0d">set_pagedir</a> (<a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *dir)</td></tr>
<tr class="memdesc:a44844a86a2d9dfe3c92936bbe16d2d0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current page directory Sets the current page directory by setting cr3 to <code>dir</code>  <a href="#a44844a86a2d9dfe3c92936bbe16d2d0d">More...</a><br/></td></tr>
<tr class="separator:a44844a86a2d9dfe3c92936bbe16d2d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62af42af2d4cb211a64978ff1ef060e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#ae62af42af2d4cb211a64978ff1ef060e">enable_paging</a> ()</td></tr>
<tr class="memdesc:ae62af42af2d4cb211a64978ff1ef060e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable paging. Enable the paging flag in cr0.  <a href="#ae62af42af2d4cb211a64978ff1ef060e">More...</a><br/></td></tr>
<tr class="separator:ae62af42af2d4cb211a64978ff1ef060e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65805eac601918e3f84e052063dac28b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a65805eac601918e3f84e052063dac28b">disable_paging</a> ()</td></tr>
<tr class="memdesc:a65805eac601918e3f84e052063dac28b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable paging. Sets the paging flag in cr0.  <a href="#a65805eac601918e3f84e052063dac28b">More...</a><br/></td></tr>
<tr class="separator:a65805eac601918e3f84e052063dac28b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569adfd13ea3c63741f64108821b1712"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a569adfd13ea3c63741f64108821b1712">paging_init</a> ()</td></tr>
<tr class="memdesc:a569adfd13ea3c63741f64108821b1712"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize paging. Creates a new page directory, and clears it. Thes creates a new page table, and fills it with addresses starting at 0. Then it sets the page tables first page table as the newly created one. Then it sets the page directory, and enables paging.  <a href="#a569adfd13ea3c63741f64108821b1712">More...</a><br/></td></tr>
<tr class="separator:a569adfd13ea3c63741f64108821b1712"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aae03e4b55dc111dae272f5f88f9a3218"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#aae03e4b55dc111dae272f5f88f9a3218">kern_start</a></td></tr>
<tr class="memdesc:aae03e4b55dc111dae272f5f88f9a3218"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start address of the kernel.  <a href="#aae03e4b55dc111dae272f5f88f9a3218">More...</a><br/></td></tr>
<tr class="separator:aae03e4b55dc111dae272f5f88f9a3218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f05feb6b1c576f3d83a427f5cd082d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a95f05feb6b1c576f3d83a427f5cd082d">kern_end</a></td></tr>
<tr class="memdesc:a95f05feb6b1c576f3d83a427f5cd082d"><td class="mdescLeft">&#160;</td><td class="mdescRight">End address of the kernel.  <a href="#a95f05feb6b1c576f3d83a427f5cd082d">More...</a><br/></td></tr>
<tr class="separator:a95f05feb6b1c576f3d83a427f5cd082d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d74d2dec403b67edcbc35310419b54"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a></td></tr>
<tr class="memdesc:a01d74d2dec403b67edcbc35310419b54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main kernel pagedirectory.  <a href="#a01d74d2dec403b67edcbc35310419b54">More...</a><br/></td></tr>
<tr class="separator:a01d74d2dec403b67edcbc35310419b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ee631b14ab62b76384e0eec3680ccb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a></td></tr>
<tr class="memdesc:a78ee631b14ab62b76384e0eec3680ccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kernels first pagetable.  <a href="#a78ee631b14ab62b76384e0eec3680ccb">More...</a><br/></td></tr>
<tr class="separator:a78ee631b14ab62b76384e0eec3680ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247734b0af2e71834b2ddc3523ffa0fa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a></td></tr>
<tr class="memdesc:a247734b0af2e71834b2ddc3523ffa0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Table stating which frames are available.  <a href="#a247734b0af2e71834b2ddc3523ffa0fa">More...</a><br/></td></tr>
<tr class="separator:a247734b0af2e71834b2ddc3523ffa0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3664686d7e92f0bca2061d088362f3d8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a3664686d7e92f0bca2061d088362f3d8">prealloc_frames</a> [20]</td></tr>
<tr class="memdesc:a3664686d7e92f0bca2061d088362f3d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">20 frames that are free, used by alloc_frame  <a href="#a3664686d7e92f0bca2061d088362f3d8">More...</a><br/></td></tr>
<tr class="separator:a3664686d7e92f0bca2061d088362f3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3337b35daceb6ab9c5edf3bf526e469a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a></td></tr>
<tr class="memdesc:a3337b35daceb6ab9c5edf3bf526e469a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of frames in the table.  <a href="#a3337b35daceb6ab9c5edf3bf526e469a">More...</a><br/></td></tr>
<tr class="separator:a3337b35daceb6ab9c5edf3bf526e469a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbce032f1a6b8fed9b601bbaa43d7be"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a></td></tr>
<tr class="memdesc:addbce032f1a6b8fed9b601bbaa43d7be"><td class="mdescLeft">&#160;</td><td class="mdescRight">The location of the first page frame.  <a href="#addbce032f1a6b8fed9b601bbaa43d7be">More...</a><br/></td></tr>
<tr class="separator:addbce032f1a6b8fed9b601bbaa43d7be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0692bf8dce3ee5883abdba6625491437"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* alloc_frame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00066">66</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00043">get_free_frame()</a>, and <a class="el" href="paging_8c_source.html#l00012">prealloc_frames</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keyword">static</span> <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> pframe = 20;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span>(pframe == 20)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">for</span>(; i &lt; 20; i++)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <a class="code" href="paging_8c.html#a3664686d7e92f0bca2061d088362f3d8">prealloc_frames</a>[i] = (<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)<a class="code" href="paging_8c.html#a4e8b2a17d9a96f0148b6a3b249669c2c">get_free_frame</a>();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="paging_8c.html#a3664686d7e92f0bca2061d088362f3d8">prealloc_frames</a>[i] == 0xFFFFFFFF) <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)0xFFFFFFFF; <span class="comment">// TODO: Add some type of handling system here</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            pframe = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)<a class="code" href="paging_8c.html#a3664686d7e92f0bca2061d088362f3d8">prealloc_frames</a>[pframe++];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="ttc" id="paging_8c_html_a3664686d7e92f0bca2061d088362f3d8"><div class="ttname"><a href="paging_8c.html#a3664686d7e92f0bca2061d088362f3d8">prealloc_frames</a></div><div class="ttdeci">static u32 prealloc_frames[20]</div><div class="ttdoc">20 frames that are free, used by alloc_frame </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00012">paging.c:12</a></div></div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
<div class="ttc" id="paging_8c_html_a4e8b2a17d9a96f0148b6a3b249669c2c"><div class="ttname"><a href="paging_8c.html#a4e8b2a17d9a96f0148b6a3b249669c2c">get_free_frame</a></div><div class="ttdeci">static void * get_free_frame()</div><div class="ttdoc">Get the first free frame. Look through ass the pages, and see if any are available. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00043">paging.c:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0dec1d6d8c55ad0fafff3656c7cee62e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear_pagedir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00101">101</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 1024; i++)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        dir[i] = 2; <span class="comment">// supervisor, rw, not present.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a65805eac601918e3f84e052063dac28b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disable_paging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00147">147</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> cr0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mov %%cr0, %0&quot;</span>: <span class="stringliteral">&quot;=b&quot;</span>(cr0));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    cr0 &amp;= ~0x80000000;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mov %0, %%cr0&quot;</span>:: <span class="stringliteral">&quot;b&quot;</span>(cr0));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae62af42af2d4cb211a64978ff1ef060e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enable_paging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00135">135</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> cr0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mov %%cr0, %0&quot;</span>: <span class="stringliteral">&quot;=b&quot;</span>(cr0));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    cr0 |= 0x80000000;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mov %0, %%cr0&quot;</span>:: <span class="stringliteral">&quot;b&quot;</span>(cr0));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac7992cc47468ac72eeb8f08f94f210d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fill_pagetable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>pointer to the page table </td></tr>
    <tr><td class="paramname">addr</td><td>address to start at </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="paging_8c_source.html#l00114">114</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 1024; i++, addr += 0x1000)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        table[i] = addr | 3;  <span class="comment">// supervisor, rw, present.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84f2e5bf7896e25c26ba9e0ea4a70715"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_frame </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00087">87</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00015">firstframe</a>, and <a class="el" href="paging_8c_source.html#l00023">set_frame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> f = (<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)frame;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    f -= (<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)<a class="code" href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    f /= 0x1000;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="paging_8c.html#a6ce6be4831ec09237b26ea3a826c6ebc">set_frame</a>(f, 0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="ttc" id="paging_8c_html_a6ce6be4831ec09237b26ea3a826c6ebc"><div class="ttname"><a href="paging_8c.html#a6ce6be4831ec09237b26ea3a826c6ebc">set_frame</a></div><div class="ttdeci">static void set_frame(u32 frame, u32 val)</div><div class="ttdoc">Makes the frame unavailable or available. Sets the current frame to be used or unused, depending on val. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00023">paging.c:23</a></div></div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
<div class="ttc" id="paging_8c_html_addbce032f1a6b8fed9b601bbaa43d7be"><div class="ttname"><a href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a></div><div class="ttdeci">static u32 * firstframe</div><div class="ttdoc">The location of the first page frame. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00015">paging.c:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e8b2a17d9a96f0148b6a3b249669c2c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* get_free_frame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00043">43</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00015">firstframe</a>, <a class="el" href="paging_8c_source.html#l00011">frames</a>, <a class="el" href="paging_8c_source.html#l00013">nframes</a>, <a class="el" href="paging_8c_source.html#l00023">set_frame()</a>, and <a class="el" href="paging_8c_source.html#l00034">test_frame()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> i = 0;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">while</span>(<a class="code" href="paging_8c.html#aec230565edc62c3911800334ba8357bb">test_frame</a>(i) != 0)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a>[i/32] == 0xFFFF)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                i += 32;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">if</span>(i == <a class="code" href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a>)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *)0xFFFFFFFF; <span class="comment">// Error, no pages available</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            i++;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="paging_8c.html#a6ce6be4831ec09237b26ea3a826c6ebc">set_frame</a>(i, 1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a> + (i*0x1000));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="ttc" id="paging_8c_html_a6ce6be4831ec09237b26ea3a826c6ebc"><div class="ttname"><a href="paging_8c.html#a6ce6be4831ec09237b26ea3a826c6ebc">set_frame</a></div><div class="ttdeci">static void set_frame(u32 frame, u32 val)</div><div class="ttdoc">Makes the frame unavailable or available. Sets the current frame to be used or unused, depending on val. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00023">paging.c:23</a></div></div>
<div class="ttc" id="paging_8c_html_aec230565edc62c3911800334ba8357bb"><div class="ttname"><a href="paging_8c.html#aec230565edc62c3911800334ba8357bb">test_frame</a></div><div class="ttdeci">static u32 test_frame(u32 frame)</div><div class="ttdoc">Checks if the frame is available Checks if the frame is not being used. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00034">paging.c:34</a></div></div>
<div class="ttc" id="paging_8c_html_a3337b35daceb6ab9c5edf3bf526e469a"><div class="ttname"><a href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a></div><div class="ttdeci">static u32 nframes</div><div class="ttdoc">Number of frames in the table. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00013">paging.c:13</a></div></div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
<div class="ttc" id="paging_8c_html_addbce032f1a6b8fed9b601bbaa43d7be"><div class="ttname"><a href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a></div><div class="ttdeci">static u32 * firstframe</div><div class="ttdoc">The location of the first page frame. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00015">paging.c:15</a></div></div>
<div class="ttc" id="paging_8c_html_a247734b0af2e71834b2ddc3523ffa0fa"><div class="ttname"><a href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a></div><div class="ttdeci">static u32 * frames</div><div class="ttdoc">Table stating which frames are available. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00011">paging.c:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a569adfd13ea3c63741f64108821b1712"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void paging_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="paging_8c.html#a0dec1d6d8c55ad0fafff3656c7cee62e" title="Clear a page directory to it&#39;s default values. Clear the page directory marking every page table as n...">clear_pagedir</a> </dd>
<dd>
<a class="el" href="paging_8c.html#ac7992cc47468ac72eeb8f08f94f210d2" title="Fill a page table with pages. Fill a pagetable with pages starting from addr and ending up at addr + ...">fill_pagetable</a> </dd>
<dd>
<a class="el" href="paging_8c.html#ae62af42af2d4cb211a64978ff1ef060e" title="Enable paging. Enable the paging flag in cr0. ">enable_paging</a> </dd></dl>

<p>Definition at line <a class="el" href="paging_8c_source.html#l00166">166</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00101">clear_pagedir()</a>, <a class="el" href="paging_8c_source.html#l00135">enable_paging()</a>, <a class="el" href="paging_8c_source.html#l00114">fill_pagetable()</a>, <a class="el" href="paging_8c_source.html#l00015">firstframe</a>, <a class="el" href="paging_8c_source.html#l00011">frames</a>, <a class="el" href="paging_8c.html#a95f05feb6b1c576f3d83a427f5cd082d">kern_end</a>, <a class="el" href="paging_8c_source.html#l00013">nframes</a>, <a class="el" href="paging_8c_source.html#l00008">pagedir</a>, <a class="el" href="paging_8c_source.html#l00009">pagetbl1</a>, and <a class="el" href="paging_8c_source.html#l00126">set_pagedir()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a> = (<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *)(((<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)&amp;<a class="code" href="paging_8c.html#a95f05feb6b1c576f3d83a427f5cd082d">kern_end</a> &amp; 0xFFFFF000) + 0x1000);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a> = <a class="code" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a> + 1024;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a> = (<a class="code" href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a> + 0x8000); <span class="comment">// Make sure if is a fair distance away from kernel paging structures</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> end_mem = 0x1000000; <span class="comment">// Temporary</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a> = end_mem / 0x1000;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> i = 0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">for</span>(; i &lt; <a class="code" href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a>; i++, <a class="code" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a>[i] = 0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="paging_8h.html#a0dec1d6d8c55ad0fafff3656c7cee62e">clear_pagedir</a>(<a class="code" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="paging_8h.html#ac7992cc47468ac72eeb8f08f94f210d2">fill_pagetable</a>(<a class="code" href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a>, 0x00000000);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a>[0] = (<a class="code" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>)<a class="code" href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a> | 3; <span class="comment">// supervisor, rw, present</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="paging_8h.html#a44844a86a2d9dfe3c92936bbe16d2d0d">set_pagedir</a>(<a class="code" href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="paging_8h.html#ae62af42af2d4cb211a64978ff1ef060e">enable_paging</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}<div class="ttc" id="paging_8h_html_ae62af42af2d4cb211a64978ff1ef060e"><div class="ttname"><a href="paging_8h.html#ae62af42af2d4cb211a64978ff1ef060e">enable_paging</a></div><div class="ttdeci">void enable_paging()</div><div class="ttdoc">Enable paging. Enable the paging flag in cr0. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00135">paging.c:135</a></div></div>
<div class="ttc" id="paging_8h_html_ac7992cc47468ac72eeb8f08f94f210d2"><div class="ttname"><a href="paging_8h.html#ac7992cc47468ac72eeb8f08f94f210d2">fill_pagetable</a></div><div class="ttdeci">void fill_pagetable(u32 *table, u32 addr)</div><div class="ttdoc">Fill a page table with pages. Fill a pagetable with pages starting from addr and ending up at addr + ...</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00114">paging.c:114</a></div></div>
<div class="ttc" id="paging_8c_html_a3337b35daceb6ab9c5edf3bf526e469a"><div class="ttname"><a href="paging_8c.html#a3337b35daceb6ab9c5edf3bf526e469a">nframes</a></div><div class="ttdeci">static u32 nframes</div><div class="ttdoc">Number of frames in the table. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00013">paging.c:13</a></div></div>
<div class="ttc" id="paging_8c_html_a01d74d2dec403b67edcbc35310419b54"><div class="ttname"><a href="paging_8c.html#a01d74d2dec403b67edcbc35310419b54">pagedir</a></div><div class="ttdeci">static u32 * pagedir</div><div class="ttdoc">Main kernel pagedirectory. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00008">paging.c:8</a></div></div>
<div class="ttc" id="types_8h_html_a10e94b422ef0c20dcdec20d31a1f5049"><div class="ttname"><a href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a></div><div class="ttdeci">unsigned int u32</div><div class="ttdoc">Unsigned 32 bit value. </div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00018">types.h:18</a></div></div>
<div class="ttc" id="paging_8h_html_a0dec1d6d8c55ad0fafff3656c7cee62e"><div class="ttname"><a href="paging_8h.html#a0dec1d6d8c55ad0fafff3656c7cee62e">clear_pagedir</a></div><div class="ttdeci">void clear_pagedir(u32 *dir)</div><div class="ttdoc">Clear a page directory to it&amp;#39;s default values. Clear the page directory marking every page table as n...</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00101">paging.c:101</a></div></div>
<div class="ttc" id="paging_8c_html_a78ee631b14ab62b76384e0eec3680ccb"><div class="ttname"><a href="paging_8c.html#a78ee631b14ab62b76384e0eec3680ccb">pagetbl1</a></div><div class="ttdeci">static u32 * pagetbl1</div><div class="ttdoc">Kernels first pagetable. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00009">paging.c:9</a></div></div>
<div class="ttc" id="paging_8c_html_addbce032f1a6b8fed9b601bbaa43d7be"><div class="ttname"><a href="paging_8c.html#addbce032f1a6b8fed9b601bbaa43d7be">firstframe</a></div><div class="ttdeci">static u32 * firstframe</div><div class="ttdoc">The location of the first page frame. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00015">paging.c:15</a></div></div>
<div class="ttc" id="paging_8h_html_a44844a86a2d9dfe3c92936bbe16d2d0d"><div class="ttname"><a href="paging_8h.html#a44844a86a2d9dfe3c92936bbe16d2d0d">set_pagedir</a></div><div class="ttdeci">void set_pagedir(u32 *dir)</div><div class="ttdoc">Set the current page directory Sets the current page directory by setting cr3 to dir ...</div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00126">paging.c:126</a></div></div>
<div class="ttc" id="paging_8c_html_a95f05feb6b1c576f3d83a427f5cd082d"><div class="ttname"><a href="paging_8c.html#a95f05feb6b1c576f3d83a427f5cd082d">kern_end</a></div><div class="ttdeci">u32 kern_end</div><div class="ttdoc">End address of the kernel. </div></div>
<div class="ttc" id="paging_8c_html_a247734b0af2e71834b2ddc3523ffa0fa"><div class="ttname"><a href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a></div><div class="ttdeci">static u32 * frames</div><div class="ttdoc">Table stating which frames are available. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00011">paging.c:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ce6be4831ec09237b26ea3a826c6ebc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_frame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame</td><td>the frame to be set </td></tr>
    <tr><td class="paramname">val</td><td>wether the frame is used or unused </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="paging_8c_source.html#l00023">23</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00011">frames</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span>(val) <a class="code" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a>[frame / 32] |=  (1 &gt;&gt; (frame % 32));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">else</span>    <a class="code" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a>[frame / 32] &amp;= ~(1 &gt;&gt; (frame % 32));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="paging_8c_html_a247734b0af2e71834b2ddc3523ffa0fa"><div class="ttname"><a href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a></div><div class="ttdeci">static u32 * frames</div><div class="ttdoc">Table stating which frames are available. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00011">paging.c:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44844a86a2d9dfe3c92936bbe16d2d0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_pagedir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> *&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>the page directory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="paging_8c_source.html#l00126">126</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mov %0, %%cr3&quot;</span>:: <span class="stringliteral">&quot;b&quot;</span>(dir));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aec230565edc62c3911800334ba8357bb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> test_frame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame</td><td>the frame to be tested </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="paging_8c_source.html#l00034">34</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

<p>References <a class="el" href="paging_8c_source.html#l00011">frames</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> ((<a class="code" href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a>[frame / 32] &amp; (1 &gt;&gt; (frame % 32))) != 0);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="ttc" id="paging_8c_html_a247734b0af2e71834b2ddc3523ffa0fa"><div class="ttname"><a href="paging_8c.html#a247734b0af2e71834b2ddc3523ffa0fa">frames</a></div><div class="ttdeci">static u32 * frames</div><div class="ttdoc">Table stating which frames are available. </div><div class="ttdef"><b>Definition:</b> <a href="paging_8c_source.html#l00011">paging.c:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="addbce032f1a6b8fed9b601bbaa43d7be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>* firstframe</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00015">15</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
<a class="anchor" id="a247734b0af2e71834b2ddc3523ffa0fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>* frames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00011">11</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
<a class="anchor" id="a95f05feb6b1c576f3d83a427f5cd082d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> kern_end</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aae03e4b55dc111dae272f5f88f9a3218"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> kern_start</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3337b35daceb6ab9c5edf3bf526e469a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> nframes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00013">13</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
<a class="anchor" id="a01d74d2dec403b67edcbc35310419b54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>* pagedir</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00008">8</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
<a class="anchor" id="a78ee631b14ab62b76384e0eec3680ccb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a>* pagetbl1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00009">9</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3664686d7e92f0bca2061d088362f3d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a10e94b422ef0c20dcdec20d31a1f5049">u32</a> prealloc_frames[20]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="paging_8c_source.html#l00012">12</a> of file <a class="el" href="paging_8c_source.html">paging.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_3dd30a497388ee684638f120a124721c.html">src</a></li><li class="navelem"><a class="el" href="dir_5b3aa51974e4a4b79bde998cacaa7abf.html">mm</a></li><li class="navelem"><a class="el" href="paging_8c.html">paging.c</a></li>
    <li class="footer">Generated on Sat Dec 7 2013 05:41:44 for Lambda OS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
